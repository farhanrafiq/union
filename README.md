# Union Employee Registry

A full-stack application for managing dealer employees and customers with admin oversight.

## ğŸš€ Quick Deploy to Render

This app is designed to run on **Render** with **Neon PostgreSQL**. No localhost setup needed!

### Prerequisites
1. **Neon Database**: Create free PostgreSQL database at [neon.tech](https://neon.tech)
2. **Render Account**: Sign up at [render.com](https://render.com)
3. **GitHub**: Push this repo to your GitHub account

### Deploy Steps

1. **Create Neon Database**
   - Go to [neon.tech](https://neon.tech) and create a free project
   - Copy your connection string (starts with `postgresql://`)

2. **Deploy to Render**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click **New** â†’ **Blueprint**
   - Connect your GitHub repository
   - Render will detect `render.yaml` and create both services:
     - Backend API (Node.js web service)
     - Frontend (Static site)

3. **Set Database URL**
   - In Render, go to your **Backend API** service
   - Go to **Environment** tab
   - Find `DATABASE_URL` and paste your Neon connection string
   - Click **Save Changes**

4. **Done!** 
   - Render will automatically deploy both services
   - Frontend will auto-connect to backend
   - Database migrations run automatically
   - `FRONTEND_ORIGIN` and `VITE_API_URL` are auto-configured

Your app will be live at: `https://union-registry-frontend.onrender.com`

---

## ğŸ”§ Local Development (Optional)

If you want to develop locally:

### Backend
```bash
cd server


---

## ğŸ—ï¸ Architecture

- **Frontend**: React + TypeScript + Vite + Tailwind CSS
- **Backend**: Express + Prisma + PostgreSQL
- **Database**: Neon PostgreSQL (serverless)
- **Auth**: JWT with HttpOnly cookies
- **Deployment**: Render (auto-deploy from GitHub)

## ğŸ“š Features

### Admin Dashboard
- Manage dealers (create, suspend, activate, delete)
- View all employees and customers across dealers
- Audit log of all actions
- Reset dealer passwords

### Dealer Dashboard
- Manage employees (add, update, terminate)
- Manage customers (add, update, terminate)
- Universal search across all records
- Profile management

### Security
- Role-based access control (Admin/Dealer)
- JWT authentication with HttpOnly cookies
- Password hashing with bcrypt
- Force password change on first login/reset
- Audit logging for compliance

## ğŸ“– Documentation

- [DEPLOYMENT.md](./DEPLOYMENT.md) - Detailed deployment instructions
- [SETUP.md](./SETUP.md) - Local development setup
- [QUICKSTART.md](./QUICKSTART.md) - Quick start guide

## ğŸ” Default Credentials

After seeding the database:

**Admin**
- Username: `admin`
- Password: Check admin password in server logs or seed file

**Demo Dealer**
- Username: `dealer1`
- Password: `Union@2025`

âš ï¸ **Change these in production!**

## ğŸ› ï¸ Tech Stack

### Frontend
- React 18
- TypeScript
- Vite
- Tailwind CSS
- Fetch API (with credentials)

### Backend
- Node.js + Express
- Prisma ORM
- PostgreSQL (Neon)
- JWT + bcrypt
- Zod validation
- Cookie-parser

### Infrastructure
- Render (hosting)
- Neon (database)
- GitHub (source control)

## ğŸ“ Environment Variables

### Backend (Render)
```
DATABASE_URL=postgresql://...  # Your Neon connection string
JWT_SECRET=auto-generated      # Auto-generated by Render
NODE_ENV=production
FRONTEND_ORIGIN=auto-linked    # Auto-linked from frontend service
```

### Frontend (Render)
```
VITE_API_URL=auto-linked       # Auto-linked from backend service
```

All environment variables are configured in `render.yaml` and auto-populated by Render Blueprint deployment.

## ğŸš¨ Troubleshooting

### "API not configured" error
- Make sure both services are deployed on Render via Blueprint
- Check that `VITE_API_URL` is set in frontend environment
- Verify backend service is running (check logs)
- Redeploy frontend with "Clear build cache & deploy"

### Database connection errors
- Verify `DATABASE_URL` is correct in backend environment
- Check Neon database is active (it may sleep after inactivity on free tier)
- Run migrations: Render does this automatically on deploy
- Check Neon connection limits (10 concurrent on free tier)

### CORS errors
- `FRONTEND_ORIGIN` should be auto-set to your frontend URL
- Check backend logs for CORS configuration
- Verify credentials are included in fetch requests (already implemented)
- Ensure both services are deployed via Blueprint

### Session not persisting
- Browser cookies must be enabled
- Check Network tab â†’ Response Headers for `Set-Cookie`
- Verify `credentials: 'include'` in fetch requests (already implemented)
- Check CORS configuration allows credentials

## ğŸ“„ License

MIT

## ğŸ‘¤ Author

Farhan Rafiq

## ğŸ™ Support

For issues or questions, please open an issue on GitHub.

---

## ğŸ”„ Updating Your Deployment

After making code changes:

```bash
git add .
git commit -m "Your changes"
git push origin main
```

Render will automatically detect the push and redeploy both services.
